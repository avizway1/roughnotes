CI/CD Tool

Continuous Integration (CI) and Continuous Delivery/Deployment (CD):


Delivery : A manual Step/action included
Deploy : No manaual step/action in the process

Jenkins help us to Automate the "Testings", "Builds" and "Deployment process".

2004 --> Kawaguchi developed hudson as a open-source tool for sun-microsystem.

2010 --> dispite between Hudson and oracle (acquired sun-micro)... Foked the project and renamed as "jenkins"

Jenkins community, Rich in plugin, good support

https://docs.aws.amazon.com/corretto/latest/corretto-21-ug/downloads-list.html


dnf install java-21-amazon-corretto -y

dnf install jenkins -y

systemctl start jenkins
systemctl enable jenkins

systemctl enable jenkins --now

---

Variables in Jenkins Projects/Pipelines/Items:

Local varibales : Works with in a job/item.

NAME=Avinash
SUBJECT=Jenkins
echo "Hello from $NAME, you are learning ${SUBJECT}"

---

System level varibales : We can add varibales at system level and we can use at any job/item.

system --> setting --> Env variables

ENV
PROJECT
SUBJECT


echo "Hello, you are working on $ENV Environment, on $PROJECT subject to learn $SUBJECT"

Hello, you are working on Production Environment, on Project-CICD subject to learn DevOps

If we have "system vas" and Local Vars.. Local variables will have priority.

---

Jenkins Variables : 

http://jenkins-svr-ip:8080/env-vars.html/


echo "hello this job name is $JOB_NAME This job is running in $NODE_NAME, We are testing this on $JENKINS_URL and Build id is $BUILD_ID"

hello this job name is jen-var-test This job is running in built-in, We are testing this on http://0.0.0.0:8080/ and Build id is 1


---

Build Options in Jenkins:

Build Periodically : Configure a Cron and jenkins performs the build based on the schedule.

Poll SCM : Same as build periodically only, but has intelligence.. It will prepare a build if any changes commited duting period.


http://65.2.130.146:8080/github-webhook/

---

Build throttle : COnfigure buiil throttle to control

Then, offload the work to newly launched ec2 instance..

1. Create a directory in new Node (under "var" directory) and add permisisons (chmod 777 remotedir) use at "remote roor directory".. 

2. Install "java" and "git" in node..

3. while adding a new node.. Add label "dev-node" "uat-name".. usage "build that match label expression".. 
launch via ssh --> add cred --> SSH --> GLobal --> "ec2-user" and Privatekey and add keyapir
Not verifying host strategy..

4. Now try to create or trigger an existing job and verify where its running..

5. Create a new item and choode "restrict where this can run" add dev-label and test it.. 

----

UserManagement in Jenkins : 


Create a user and verify the user settings.. He can do anything..
--> Reason : under security.. "logged in user can do anything "".. 
test "allow anonomus access"..
test "keep me signedin".. "register"..

matrix:
Tryout.. Matrix based security.. whatever user we are adding, he should have overall read permissions""
add user "xyz" -->  
add user "anudeep" (should already created) --> dont give delete on joba, but give all other permisisons..


Now, create 4 projects i.e; dev-proj1 dev-proj2, uat-proj1 and uat-proj2.. we cant achieve this using "matrix"

anudeep --> devprojects
aravind --> uatprojects

to chieve this, install plugins "Role base wuthrorisation starategy"

now, navigate to security.. enable "role based auth strategy"..  then we get new option under security "manage and assign role"

now, create a "overall read role".. without it we cant do anything.. 
under "manage roles" --> "read-mandatory" --> choose "overall read"

naviagte to "assign roles".. "global roles"  --> add user "anudeep" --> assign "read mandatory"
and add "aravind" user and --> assign "read mandatory"

login as these users and verify nothing available.. 

Now.. GO to "manage roles" --> "item roles" -->  role to add "dev-role" --> pattern "dev.*" --> then choose the permisisons.. 
GO to "manage roles" --> "item roles" -->  role to add "uat-role" --> pattern "dev.*" --> then choose the permisisons.. 

Now, navigate to "assign roles".. add user .. then user "item role" assign users with appropriate .. and test.. 

---

--> To change look and feel, tryout the plugins.. 


---

Maven : 

pom .xml pom.xml (Project Object Model)

--> Manages the dependencies
--> Standardise the build process
--> We can use with CICD pipelines for build automation


---
JAR File (Java ARchieve) : 
.class files
--> Packaging a standalone java application, we can use this jar.

java -jar /path-to-jar/sample.jar


.
├── pom.xml
└── src
    ├── main
    │   └── java
    │       └── mydemo
    │           └── App.java
    └── test
        └── java
            └── mydemo
                └── AppTest.java

7 directories, 3 files

---


.
├── pom.xml
├── src
│   ├── main
│   │   └── java
│   │       └── mydemo
│   │           └── App.java
│   └── test
│       └── java
│           └── mydemo
│               └── AppTest.java
└── target
    ├── classes
    │   └── mydemo
    │       └── App.class
    ├── generated-sources
    │   └── annotations
    └── maven-status
        └── maven-compiler-plugin
            └── compile
                └── default-compile
                    ├── createdFiles.lst
                    └── inputFiles.lst

16 directories, 6 files

---


.
├── pom.xml
├── src
│   ├── main
│   │   └── java
│   │       └── mydemo
│   │           └── App.java
│   └── test
│       └── java
│           └── mydemo
│               └── AppTest.java
└── target
    ├── avinash-1.0-SNAPSHOT.jar
    ├── classes
    │   └── mydemo
    │       └── App.class
    ├── generated-sources
    │   └── annotations
    ├── generated-test-sources
    │   └── test-annotations
    ├── maven-archiver
    │   └── pom.properties
    ├── maven-status
    │   └── maven-compiler-plugin
    │       ├── compile
    │       │   └── default-compile
    │       │       ├── createdFiles.lst
    │       │       └── inputFiles.lst
    │       └── testCompile
    │           └── default-testCompile
    │               ├── createdFiles.lst
    │               └── inputFiles.lst
    ├── surefire-reports
    │   ├── TEST-mydemo.AppTest.xml
    │   └── mydemo.AppTest.txt
    └── test-classes
        └── mydemo
            └── AppTest.class

24 directories, 13 files



---


[INFO] Installing 
/home/ec2-user/avinash/pom.xml to /root/.m2/repository/mydemoproj/avinash/1.0-SNAPSHOT/avinash-1.0-SNAPSHOT.pom

[INFO] Installing /home/ec2-user/avinash/target/avinash-1.0-SNAPSHOT.jar to /root/.m2/repository/mydemoproj/avinash/1.0-SNAPSHOT/avinash-1.0


---

mvn clean

---

mvn clean install package


---


find / -name context.xml

vim /opt/apache-tomcat-10.1.44/webapps/host-manager/META-INF/context.xml
vim /opt/apache-tomcat-10.1.44/webapps/manager/META-INF/context.xml


---


vim /opt/apache-tomcat-10.1.44/conf/tomcat-users.xml

tomcat
s3cret


<role rolename="manager-gui"/>
<role rolename="manager-script"/>
<role rolename="manager-jmx"/>
<role rolename="manager-status"/>
<role rolename="admin-gui"/>
<user username="tomcat" password="Avinash" roles="manager-gui,manager-script,manager-jmx,manager-status,admin-gui"/>


---

Create a softlink with a string to perform easy start and stop operation..


ln -s /opt/apache-tomcat-10.1.44/bin/startup.sh /usr/bin/tomcatstart
ln -s /opt/apache-tomcat-10.1.44/bin/shutdown.sh /usr/bin/tomcatstop


---



pipeline























